version: '2'
services:
  wsgi:
    build: .
    image: swisstopo/mf-chsdi3:python3.7
    env_file:
    - ${RANCHER_LABEL}.env
    environment:
      PGUSER: ${PGUSER}
      PGPASSWORD: ${PGPASSWD}
    # network_mode: "host"
    command:
      - /usr/sbin/apache2ctl
      - "-D"
      - "FOREGROUND"
    ports:
      - "${WSGI_PORT}:80"
    labels:
      io.rancher.scheduler.affinity:host_label: application=print,staging=${RANCHER_LABEL}
      io.rancher.container.pull_image: always
      io.rancher.scheduler.global: 'true'
